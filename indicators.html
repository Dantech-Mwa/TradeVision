<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Indicators – TradeVision</title>
  <link rel="icon" href="assets/icons/chart.svg" type="image/svg+xml">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <!-- technicalindicators – 120+ indicators -->
  <script src="https://cdn.jsdelivr.net/npm/technicalindicators@3"></script>

  <style>
    :root{--bg:#141518;--bg-light:#1e222d;--text:#d1d4dc;--text-light:#9ea1b5;--accent:#2962ff;--green:#26a69a;--red:#ef5350;--border:#2d313e;--card:#1e222d;}
    [data-theme="light"]{--bg:#ffffff;--bg-light:#f8f9fa;--text:#2d3748;--text-light:#718096;--accent:#2962ff;--green:#26a69a;--red:#ef5350;--border:#e2e8f0;--card:#ffffff;}
    body{margin:0;font-family:'Inter',sans-serif;background:var(--bg);color:var(--text);}
    a{color:var(--accent);text-decoration:none;}
    .container{max-width:1200px;margin:0 auto;padding:2rem 1rem;}
    .header{background:var(--bg-light);border-bottom:1px solid var(--border);padding:.75rem 0;position:sticky;top:0;z-index:100;}
    .flex-between{display:flex;justify-content:space-between;align-items:center;}
    .logo{font-weight:700;font-size:1.4rem;color:var(--accent);}
    .logo i{font-size:1.5rem;}
    .nav-links a{margin:0 .75rem;font-weight:500;}
    .icon-btn{background:none;border:none;color:var(--text-light);font-size:1.2rem;cursor:pointer;padding:.5rem;}

    .search-bar{margin:1.5rem 0;}
    .search-bar input{width:100%;max-width:420px;padding:.6rem 1rem;border:1px solid var(--border);border-radius:8px;background:var(--card);color:var(--text);font-size:1rem;}
    .indicator-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:1rem;margin-top:1rem;}
    .indicator-card{background:var(--card);border:1px solid var(--border);border-radius:10px;padding:1rem;cursor:pointer;transition:.2s;}
    .indicator-card:hover{transform:translateY(-3px);box-shadow:0 6px 16px rgba(0,0,0,.25);}
    .indicator-card h3{margin:0 0 .4rem;font-size:1.15rem;}
    .indicator-card p{font-size:.9rem;color:var(--text-light);margin:0;}
    .category{margin:2rem 0 .5rem;font-weight:600;color:var(--accent);font-size:1.1rem;}
    .footer{background:var(--bg-light);border-top:1px solid var(--border);padding:1rem 0;font-size:.8rem;text-align:center;color:var(--text-light);}
  </style>
</head>

<body data-theme="dark">
  <header class="header">
    <div class="container flex-between">
      <div class="logo"><a href="index.html" class="flex-center"><i class="fas fa-chart-line"></i><span>TradeVision</span></a></div>
      <nav class="nav-links">
        <a href="chart.html">Chart</a>
        <a href="watchlist.html">Watchlist</a>
        <a href="screener.html">Screener</a>
        <a href="ideas.html">Ideas</a>
        <a href="alerts.html">Alerts</a>
      </nav>
      <div class="header-actions">
        <button id="theme-toggle" class="icon-btn"><i class="fas fa-moon"></i></button>
      </div>
    </div>
  </header>

  <div class="container">
    <h1>Indicators Library (120+)</h1>

    <div class="search-bar">
      <input type="text" id="indicator-search" placeholder="Search indicators… (RSI, MACD, Bollinger, etc.)">
    </div>

    <!-- Cards will be injected here -->
    <div id="indicator-container"></div>
  </div>

  <footer class="footer">
    <div class="container">© 2025 TradeVision. Open Source.</div>
  </footer>

  <script>
    /* --------------------------------------------------------------
       1. Theme toggle
       -------------------------------------------------------------- */
    const themeToggle = document.getElementById('theme-toggle');
    const body = document.body;
    const themeIcon = themeToggle.querySelector('i');
    themeToggle.addEventListener('click', () => {
      const isDark = body.getAttribute('data-theme') === 'dark';
      body.setAttribute('data-theme', isDark ? 'light' : 'dark');
      themeIcon.classList.toggle('fa-moon'); themeIcon.classList.toggle('fa-sun');
      localStorage.setItem('theme', isDark ? 'light' : 'dark');
    });
    const savedTheme = localStorage.getItem('theme') || 'dark';
    body.setAttribute('data-theme', savedTheme);
    if (savedTheme === 'light') themeIcon.classList.replace('fa-moon', 'fa-sun');

    /* --------------------------------------------------------------
       2. All indicators from technicalindicators
       -------------------------------------------------------------- */
    const TI = window.TI;               // global exported by the CDN
    const allIndicators = Object.keys(TI)
      .filter(k => typeof TI[k] === 'function' && k !== 'Indicator')
      .map(name => ({
        name,
        fn: TI[name],
        description: (TI[name].description || `Calculates ${name}`) + '.'
      }))
      .sort((a,b) => a.name.localeCompare(b.name));

    /* --------------------------------------------------------------
       3. Render cards (grouped by first letter for nicer UX)
       -------------------------------------------------------------- */
    const container = document.getElementById('indicator-container');
    let lastLetter = '';
    allIndicators.forEach(ind => {
      const first = ind.name[0].toUpperCase();
      if (first !== lastLetter) {
        lastLetter = first;
        const cat = document.createElement('div');
        cat.className = 'category';
        cat.textContent = first;
        container.appendChild(cat);
      }

      const card = document.createElement('div');
      card.className = 'indicator-card';
      card.dataset.name = ind.name;
      card.innerHTML = `<h3>${ind.name}</h3><p>${ind.description}</p>`;
      card.title = `Add ${ind.name} to the chart`;
      card.addEventListener('click', () => addIndicatorToChart(ind.name));
      container.appendChild(card);
    });

    /* --------------------------------------------------------------
       4. Live search
       -------------------------------------------------------------- */
    const searchInput = document.getElementById('indicator-search');
    searchInput.addEventListener('input', () => {
      const term = searchInput.value.trim().toLowerCase();
      document.querySelectorAll('.indicator-card').forEach(c => {
        const txt = c.textContent.toLowerCase();
        c.style.display = txt.includes(term) ? '' : 'none';
      });
    });

    /* --------------------------------------------------------------
       5. Add indicator → localStorage → chart.html reads it
       -------------------------------------------------------------- */
    function addIndicatorToChart(name) {
      let added = JSON.parse(localStorage.getItem('chartIndicators') || '[]');
      if (!added.includes(name)) {
        added.push(name);
        localStorage.setItem('chartIndicators', JSON.stringify(added));
        alert(`${name} added! Open chart.html to see it plotted.`);
      } else {
        alert(`${name} is already on the chart.`);
      }
    }

    /* --------------------------------------------------------------
       6. (Optional) Clear all indicators from the chart
       -------------------------------------------------------------- */
    // Uncomment if you want a “Clear all” button
    const clearBtn = document.createElement('button');
    clearBtn.textContent = 'Clear All Indicators';
    clearBtn.style.marginTop = '1rem';
    clearBtn.onclick = () => { localStorage.removeItem('chartIndicators'); alert('All cleared'); };
     document.querySelector('.container').appendChild(clearBtn);
  </script>
</body>
</html>
